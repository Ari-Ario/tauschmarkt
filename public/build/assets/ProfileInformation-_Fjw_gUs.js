import{_ as Z,r as d,u as H,m as O,a as D,o as n,c as i,d as a,b as m,F,s as A,j as S,n as B,e as C,w as G,t as T,f as N,v as P,q as h,p as K,h as R,k as W,S as $}from"./app-D8tagWsk.js";import{F as J}from"./FooterUser-Di210AOo.js";import{F as L}from"./FooterSeller-CMlmVdmk.js";import{l as X,H as Y}from"./Header-BmOdKlL7.js";/* empty css                                                                   */const g=f=>(K("data-v-f0a76fc9"),f=f(),R(),f),ee={class:"container"},te={class:"profile-page"},ae=g(()=>a("div",{class:"account-details"},[a("h3",null,"Meine Profil")],-1)),se=["onClick"],oe={class:"profile-value"},ne=g(()=>a("span",null,"Betriebsort fehlt",-1)),ie=g(()=>a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#298E46"},[a("path",{d:"M480-480q33 0 56.5-23.5T560-560q0-33-23.5-56.5T480-640q-33 0-56.5 23.5T400-560q0 33 23.5 56.5T480-480Zm0 294q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Zm0-480Z"})],-1)),re={key:2},le={key:3},ue={key:4,class:"edit-popup"},ce=["for"],de=["id"],pe=["id"],me=g(()=>a("button",{type:"submit",style:{"margin-bottom":"10px"}},"Speichern",-1)),fe={__name:"ProfileInformation",setup(f){var V;d([]);const y=d(!1),s=d(""),o=d(""),c=d({}),q=d({}),k=d({}),v={firstname:"Vorname",lastname:"Nachname",email:"Email",street:"Strasse",house_number:"Hausnummer",city:"Stadt",zip_code:"Postleitzahl",opening:"öffnungszeit",closing:"Betriebsschluss",payment:"Bankkonto"},r=H();W();const I=(V=r==null?void 0:r.authUser)==null?void 0:V.id,U=async()=>{try{const e=await(await h.get(`api/user/profile/${I}`)).data;c.value={Vorname:e.firstname,Nachname:e.lastname,Strasse:e.street,Hausnummer:e.house_number,Stadt:e.city,Postleitzahl:e.zip_code,öffnungszeit:e.opening,Betriebsschluss:e.closing,Bankkonto:e.payment},k.value={latitude:e.latitude,longitude:e.longitude},q.value={connect:e.connect_id,payment_intent:e.payment_intent_id}}catch(t){console.error("Error loading profile:",t)}},j=async()=>{try{const e=await(await h.get(`api/user/profile/${I}`)).data;c.value={Vorname:e.firstname,Nachname:e.lastname,Strasse:e.street,Hausnummer:e.house_number,Stadt:e.city,Postleitzahl:e.zip_code}}catch(t){console.error("Error loading profile:",t)}};O(()=>{var t;(t=r==null?void 0:r.authUser)!=null&&t.is_seller?U():j()});const x=(t,e)=>{s.value=e,o.value=t,y.value=!0};X("pk_test_51PRVFGCFV0u7TeyesIGWN1GPVFilQQt6QbXmQX540ziEJj7k5F6j3SJ4tuUI6hLrdZdcQNIMZoqeu2lNWzFjn7to00axcktAOT");const M=async()=>{if(s.value!==null){const t=Object.keys(v).find(e=>v[e]===s.value);if(t){if(t==="payment"&&c.value[s.value]===o.value&&q.value.connect){$.fire({icon:"info",title:"Keine Änderungen festgestellt",text:"Der Eingabewert ist derselbe wie der vorhandene Wert."}),b();return}c.value[s.value]=o.value;const e=Object.fromEntries(Object.entries(c.value).map(([l,p])=>[Object.keys(v).find(_=>v[_]===l),p]));try{const l=await h.put("/api/user/update-profile",e);if(console.log("Profile updated:",l.data),t==="payment"){const p=await h.get("/api/onboard-seller");window.location.href=p.data.url}}catch(l){console.error("Error updating profile:",l)}}}b()},b=()=>{y.value=!1,s.value={},o.value=""},Q=t=>t.split(":").length===2?`${t}:00`:t;return(t,e)=>{var p,_,z,E;const l=D("router-link");return n(),i(F,null,[a("header",null,[m(Y)]),a("div",ee,[a("div",te,[ae,c.value?(n(!0),i(F,{key:0},A(c.value,(u,w)=>(n(),i("div",{class:"profile-section",key:w},[a("div",{class:"profile-item",onClick:()=>x(u,w)},[a("span",null,T(w),1),a("span",oe,T(u),1)],8,se)]))),128)):S("",!0),(_=(p=B(r))==null?void 0:p.authUser)!=null&&_.is_seller&&!k.value.latitude&&!k.value.longitude?(n(),i("div",{key:1,class:"profile-item",onClick:e[0]||(e[0]=()=>x(t.value,t.key))},[m(l,{to:{name:"map"},class:"link"},{default:C(()=>[ne]),_:1}),m(l,{to:{name:"map"},class:"link"},{default:C(()=>[ie]),_:1})])):S("",!0),(E=(z=B(r))==null?void 0:z.authUser)!=null&&E.is_seller?(n(),i("div",re,[m(L)])):(n(),i("div",le,[m(J)])),y.value?(n(),i("div",ue,[a("form",{onSubmit:G(M,["prevent"])},[a("label",{for:s.value},T(s.value),9,ce),s.value==="öffnungszeit"||s.value==="Betriebsschluss"?N((n(),i("input",{key:0,type:"time","onUpdate:modelValue":e[1]||(e[1]=u=>o.value=u),id:s.value,required:"",onChange:e[2]||(e[2]=u=>o.value=Q(u.target.value))},null,40,de)),[[P,o.value]]):N((n(),i("input",{key:1,type:"text","onUpdate:modelValue":e[3]||(e[3]=u=>o.value=u),id:s.value,required:""},null,8,pe)),[[P,o.value]]),me,a("button",{type:"button",onClick:b},"Ablehnen")],32)])):S("",!0)])])],64)}}},ke=Z(fe,[["__scopeId","data-v-f0a76fc9"]]);export{ke as default};
