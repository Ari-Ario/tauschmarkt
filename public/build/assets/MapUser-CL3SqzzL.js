import{_ as B,r as i,l as M,m as A,a as H,o as f,c as S,b as m,e as C,d as a,n as r,w as D,f as G,v as N,t as Q,F as L,q as W,s as z,x as K,p as j,h as Y,i as Z}from"./app-D8tagWsk.js";import{S as w,P as $,E as q}from"./index-BeaQipUu.js";import{l as c,s as I,a as J}from"./locals-BxkJDxKa.js";var X={VITE_BASE_URL:"https://kleinhaendler.ch/api",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_51PRVFGCFV0u7TeyesIGWN1GPVFilQQt6QbXmQX540ziEJj7k5F6j3SJ4tuUI6hLrdZdcQNIMZoqeu2lNWzFjn7to00axcktAOT",VITE_PUSHER_APP_KEY:"",VITE_PUSHER_HOST:"",VITE_PUSHER_PORT:"",VITE_PUSHER_SCHEME:"",VITE_PUSHER_APP_CLUSTER:"",BASE_URL:"/build/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const x=p=>(j("data-v-b6b83053"),p=p(),Y(),p),ee=x(()=>a("div",{class:"back"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#298E46"},[a("path",{d:"M400-80 0-480l400-400 71 71-329 329 329 329-71 71Z"})])],-1)),te={class:"map-container"},oe={class:"controls"},ae=x(()=>a("h4",null,"Distanz wÃ¤hlen",-1)),le={class:"slider-container"},ne={__name:"MapUser",setup(p){const y=Z(),h=i(null),n=i({lat:46.938749674988486,lng:7.459564360522899}),s=i(10);i("");const v=i(null),E=i([]),T=X.VUE_APP_GOOGLE_MAP_API_KEY,d=i({center:n.value,radius:s.value*1e3,fillColor:"#0088ff",fillOpacity:.2,strokeColor:"#0088ff",strokeOpacity:.5,strokeWeight:2});M([n,s],()=>{d.value={...d.value,center:n.value,radius:s.value*1e3},k()});const _=()=>{d.value={...d.value,radius:s.value*1e3},k()},b=e=>{if(e.geometry){n.value={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()},c.value={latitude:e.geometry.location.lat(),longitude:e.geometry.location.lng()},_();const t=e.address_components;let l="";for(const o of t)if(o.types.includes("locality")){l=o.long_name;break}console.log(`City: ${l}`)}else console.error("Place has no geometry")},k=()=>{if(v.value){const e=new google.maps.LatLngBounds,t=new google.maps.LatLng(n.value.lat,n.value.lng),l=s.value*1e3,o=google.maps.geometry.spherical.computeOffset(t,l,45),u=google.maps.geometry.spherical.computeOffset(t,l,225);e.extend(t),e.extend(o),e.extend(u),v.value.fitBounds(e)}},R=e=>{n.value={lat:e.latLng.lat(),lng:e.latLng.lng()},c.value={latitude:e.latLng.lat(),longitude:e.latLng.lng()},_()},V=async(e,t,l,o)=>{try{const u=await W.get(`/api/enterprises/${o}`,{params:{latitude:e,longitude:t,distance:l}});E.value=u.data}catch(u){console.error("Error loading enterprises:",u)}},P=A(async()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async e=>{h.value={lat:e.coords.latitude,lng:e.coords.longitude},n.value=h.value,c.value={latitude:e.coords.latitude,longitude:e.coords.longitude},await V(c.value.latitude,c.value.longitude,s.value,1)}):console.error("Geolocation is not supported by this browser.")}),g=i(null),F=()=>{if(g.value)return;const e=document.getElementById("autocomplete");g.value=new google.maps.places.Autocomplete(e,{types:["(cities)"]}),g.value.addListener("place_changed",()=>{const t=g.value.getPlace();if(t.geometry){const l=t.geometry.location.lat(),o=t.geometry.location.lng();I(l,o),console.log(`City: ${t.formatted_address}`)}else console.error("Place has no geometry")})},O=e=>{y.push({name:"index",params:{id:e}})},U=()=>{I(c.value.latitude,c.value.longitude),J(s.value),y.push({name:"home"})};return(e,t)=>{const l=H("router-link");return f(),S(L,null,[m(l,{to:{name:"home"},class:"link"},{default:C(()=>[ee]),_:1}),a("div",te,[m(r(q),{"api-key":r(T),center:n.value,zoom:10,style:{width:"100%",height:"100%"},onLoad:t[0]||(t[0]=o=>v.value.value=o),onClick:R},{default:C(()=>[(f(!0),S(L,null,z(E.value,o=>(f(),K(r(w),{key:o.id,options:{center:{lat:parseFloat(o.latitude),lng:parseFloat(o.longitude)},radius:500,fillColor:"#FF0000",fillOpacity:.5,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2},onClick:()=>O(o.id)},null,8,["options","onClick"]))),128)),m(r(w),{options:d.value},null,8,["options"]),m(r($),{options:{position:n.value}},null,8,["options"])]),_:1},8,["api-key","center"]),a("form",{onSubmit:t[2]||(t[2]=D((...o)=>r(P)&&r(P)(...o),["prevent"])),class:"location-form"},[a("div",oe,[a("input",{id:"autocomplete",type:"text",placeholder:"Enter a city or location",onFocus:F},null,32),a("button",{onClick:b},"Stadt suchen"),ae,a("div",le,[G(a("input",{type:"range",min:"1",max:"20","onUpdate:modelValue":t[1]||(t[1]=o=>s.value=o),onInput:_},null,544),[[N,s.value]]),a("span",null,Q(s.value)+" km",1)]),a("button",{onClick:U},"Suchen")])],32)])],64)}}},ce=B(ne,[["__scopeId","data-v-b6b83053"]]);export{ce as default};
